let express,db,getTotalConfirmed,getTotalRecovered,getTotalDeaths,getWorldInformation;_410‍.w("express",[["default",["express"],function(v){express=v}]]);_410‍.w("./lib/db",[["default",["db"],function(v){db=v}]]);_410‍.w("./lib/cron");_410‍.w("./lib/scrapper",[["getTotalConfirmed",["getTotalConfirmed"],function(v){getTotalConfirmed=v}],["getTotalRecovered",["getTotalRecovered"],function(v){getTotalRecovered=v}],["getTotalDeaths",["getTotalDeaths"],function(v){getTotalDeaths=v}],["getWorldInformation",["getWorldInformation"],function(v){getWorldInformation=v}]]);









//db setup

const app = express();

app.get("/scrape", async (req, res, next) => {
  console.log("Scrapping");
  const [c, r, d] = await Promise.all([
    getTotalConfirmed(),
    getTotalRecovered(),
    getTotalDeaths(),
  ]);
  res.json({ c, r, d });
});

app.get("/data/:country", async (req, res, next) => {
  //get data

  _410‍.g.console.log(req.params.country);
  const test = await getTotalConfirmed(req.params.country);
  _410‍.g.console.log(test);

  const data = await getWorldInformation();
  _410‍.g.console.log(data);

  // console.log(req.params);
  const worldwide = db.value();
  res.setHeader("Access-Control-Allow-Origin", "*");
  res.json(worldwide);
  //respond json
});
app.get("/data/", async (req, res, next) => {
  //get data

  console.log("Scrapping");
  const worldwide = db.value();
  res.setHeader("Access-Control-Allow-Origin", "*");
  res.json(worldwide);
  //respond json
});

app.listen(2093, () => {
  console.log(
    `example app running on port http://localhost:2093 started at ${new Date().getHours()}`
  );
});
